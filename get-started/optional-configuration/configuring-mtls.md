---
description: >-
  In this section, you will find how to configure MTLS in your Charles'
  installation.
---

# Configuring MTLS

{% hint style="info" %}
_**Mutual Transport Layer Security**_ **\(MTLS\)** is recommended when you want to **install Charles in a different cluster where your applications are**. 
{% endhint %}

This configuration is necessary to guarantee safe communication between Charles' services because they can be exposed in a different cluster. In this scenario, only one Charles component needs to be in the same cluster of your applications: `charlescd-butler`.

## How to enable MTLS? 

Follow the steps below to enable MTLS in your application: 

**Step 1:** Access **`charlescd/install/mtls-job/values.yaml`**  and add the domain where you will use Charles, see the example below: 

```text
mtls:
  domain: .charles.com
  enabled: true
```

**Step 2:** Run the manifest, it generates secrets with certificates for each component and the certified authority. 

{% hint style="warning" %}
The certificates generated will be self-signed. 
{% endhint %}

**Step 3:** In the project's root folder, run the command below: 

```yaml
helm install mtls-job ./install/mtls-job/ --namespace charlescd --values=./install/mtls-job/values.yaml
```

**Step 4:** If you want to use your own certificates and not the ones generated by the job, use the ****[**create secrets script** ](https://github.com/ZupIT/charlescd/blob/security/mtls/install/helm-chart/scripts/create-tls-secrets.sh)to help you.

**Step 5:** Copy a cluster's secret to another, and now:  

* Copy the secrets inside the yaml's manifests, to do that use the [**'copy secrets' script**](https://github.com/ZupIT/charlescd/blob/security/mtls/install/helm-chart/scripts/copy-secrets.sh);
* Apply the manifest in the destination cluster using the [**'apply secrets' script**](https://github.com/ZupIT/charlescd/blob/security/mtls/install/helm-chart/scripts/apply-secrets.sh).

**Step 6:** Access **`charlescd/install/helm-chart/values.yaml`,**  in moove's configuration and change the property value **`mtls/enabled`** to**`true` .** Check out below: ****

```yaml
moove:
    mtls:
      enabled: true
```

**Step 7:** Make the same change you did in step 6, but now for the **butler component**, when you want to install in another cluster, see the example below: 

```yaml
butler:
    mtls:
        enabled: true
```

**Step 8:** Now, follow Charles' installation steps. 

